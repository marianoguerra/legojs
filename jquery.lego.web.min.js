/*global console, window*/(function(a){function d(a){for(var b in a)if(a.hasOwnProperty(b))return b}function e(a,b){var c;for(c in b)b[c]&&(a[c]=b[c]);return a}function f(a,b,c,d){return{a:e({href:a,$childs:b},{id:c,"class":d})}}function g(a,b,c,d){return{input:e({type:a,value:b||""},{id:c,"class":d})}}function h(a,b,c){return g("text",a,b,c)}function i(a,b,c){return{button:e({$childs:a},{id:b,"class":c})}}function j(a,b){return{img:{src:a,alt:b}}}function k(a){return{li:{$childs:a}}}function l(a,b,c,d,e){return f(a,j(b,c),d,e)}function m(a,b,c,d){var f={};return f[a]=e({$childs:b},{id:c,"class":d}),f}function n(a,b,c){return m("div",a,b,c)}function o(a,b,c){return m("div",a,b,c)}"use strict";if(a.lego)return a;var b,c="blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" ");a.lego=function(b){var e,f,g,h,i,j;if(typeof b=="string")return a.lego(p.parse(b));if(a.isArray(b))return a.map(b,function(b){return a.lego(b)});e=d(b),j=b[e],b=e,f=a("<"+b+">");if(j)if(typeof j=="string")f.html(j);else for(e in j){if(e==="$childs"){h=j[e],a.isArray(h)||(h=[h]);for(g=0;g<h.length;g+=1)a.isPlainObject(h[g])?a.lego(h[g]).appendTo(f):f.append(h[g])}j.hasOwnProperty(e)&&(e[0]==="$"?(i=e.slice(1),i!=="childs"&&(a.inArray(i,c)!==-1?f[i](j[e]):a.isFunction(j[e])?a.bind(i,j[e]):a.lego.error("unknown internal attribute "+i))):e[0]==="@"?(i=e.slice(1),f.data(i,j[e])):f.attr(e,j[e]))}return f},window.console&&console.error?a.lego.error=console.error:a.lego.error=function(){},b=a.lego,b.link=f,b.img=j,b.li=k,b.imglink=l,b.div=n,b.span=o,b.input=g,b.text=h,b.button=i;var p=function(){var a={trace:function(){},yy:{},symbols_:{error:2,root:3,node_sibling:4,EOF:5,node_child:6,"+":7,node_text:8,">":9,TEXT:10,node_times:11,node:12,"*":13,NUMBER:14,IDENTIFIER:15,attrs:16,classes:17,id:18,"(":19,")":20,"#":21,"class":22,".":23,"[":24,attrvals:25,"]":26,attrval:27,"=":28,STRING:29,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"+",9:">",10:"TEXT",13:"*",14:"NUMBER",15:"IDENTIFIER",19:"(",20:")",21:"#",23:".",24:"[",26:"]",28:"=",29:"STRING"},productions_:[0,[3,2],[4,1],[4,3],[6,1],[6,3],[8,1],[8,1],[8,2],[11,1],[11,3],[12,1],[12,1],[12,1],[12,1],[12,2],[12,2],[12,2],[12,3],[12,2],[12,2],[12,3],[12,2],[12,3],[12,3],[12,4],[12,3],[18,2],[22,2],[17,1],[17,2],[16,3],[27,3],[25,1],[25,2]],performAction:function(b,c,d,e,f,g,h){var i=g.length-1;switch(f){case 1:return g[i-1];case 2:this.$=g[i];break;case 3:this.$=g[i-2].concat(g[i]);break;case 4:this.$=g[i];break;case 5:var j,k,l,m=unescape("%24childs");for(j in g[i-2])for(k in g[i-2][j]){l=g[i-2][j],l[k][m]=(l[k][m]||[]).concat(g[i]);break}this.$=g[i-2];break;case 6:this.$=[g[i].slice(1,g[i].length-1)];break;case 7:this.$=g[i];break;case 8:var j,k,l,m=unescape("%24childs");for(j in g[i-1])for(k in g[i-1][j]){l=g[i-1][j],l[k][m]=l[k][m]||[],l[k][m].push(g[i].slice(1,g[i].length-1));break}this.$=g[i-1];break;case 9:this.$=[].concat(g[i]);break;case 10:var j,n=[];size=parseInt(g[i],10),l;for(j=0;j<size;j+=1){l=JSON.parse(JSON.stringify(g[i-2]));for(k in l){l[k].id&&(l[k].id=l[k].id.replace(/\$/g,""+(j+1)));break}n.push(l)}this.$=n;break;case 11:var l={};l[g[i]]={},this.$=l;break;case 12:this.$={div:g[i]};break;case 13:this.$={div:{"class":g[i]}};break;case 14:this.$={div:{id:g[i]}};break;case 15:this.$={div:{id:g[i-1],"class":g[i]}};break;case 16:var l=g[i-1];l["class"]=g[i],this.$={div:l};break;case 17:var l=g[i-1];l.id=g[i],this.$={div:l};break;case 18:var l=g[i-2];l.id=g[i-1],l["class"]=g[i],this.$={div:l};break;case 19:var l={};l[g[i-1]]={id:g[i]},this.$=l;break;case 20:var l={};l[g[i-1]]={"class":g[i]},this.$=l;break;case 21:var l={};l[g[i-2]]={id:g[i-1],"class":g[i]},this.$=l;break;case 22:var l={};l[g[i-1]]=g[i],this.$=l;break;case 23:var l={};l[g[i-2]]=g[i-1],l[g[i-2]].id=g[i],this.$=l;break;case 24:var l={};l[g[i-2]]=g[i-1],l[g[i-2]]["class"]=g[i],this.$=l;break;case 25:var l={};l[g[i-3]]=g[i-2],l[g[i-3]].id=g[i-1],l[g[i-3]]["class"]=g[i],this.$=l;break;case 26:this.$=g[i-1];break;case 27:this.$=g[i];break;case 28:this.$=[g[i]];break;case 29:this.$=g[i];break;case 30:this.$=g[i-1].concat(g[i]);break;case 31:this.$=g[i-1];break;case 32:var l={};l[g[i-2]]=g[i].slice(1,g[i].length-1),this.$=l;break;case 33:this.$=g[i];break;case 34:for(var k in g[i-1])g[i][k]=g[i-1][k];this.$=g[i]}},table:[{3:1,4:2,6:3,8:4,10:[1,5],11:6,12:7,15:[1,8],16:9,17:10,18:11,19:[1,12],21:[1,15],22:14,23:[1,16],24:[1,13]},{1:[3]},{5:[1,17]},{5:[2,2],7:[1,18],20:[2,2]},{5:[2,4],7:[2,4],9:[1,19],20:[2,4]},{5:[2,6],7:[2,6],9:[2,6],20:[2,6]},{5:[2,7],7:[2,7],9:[2,7],10:[1,20],20:[2,7]},{5:[2,9],7:[2,9],9:[2,9],10:[2,9],13:[1,21],20:[2,9]},{5:[2,11],7:[2,11],9:[2,11],10:[2,11],13:[2,11],16:24,17:23,18:22,20:[2,11],21:[1,15],22:14,23:[1,16],24:[1,13]},{5:[2,12],7:[2,12],9:[2,12],10:[2,12],13:[2,12],17:25,18:26,20:[2,12],21:[1,15],22:14,23:[1,16]},{5:[2,13],7:[2,13],9:[2,13],10:[2,13],13:[2,13],20:[2,13]},{5:[2,14],7:[2,14],9:[2,14],10:[2,14],13:[2,14],17:27,20:[2,14],22:14,23:[1,16]},{4:28,6:3,8:4,10:[1,5],11:6,12:7,15:[1,8],16:9,17:10,18:11,19:[1,12],21:[1,15],22:14,23:[1,16],24:[1,13]},{15:[1,31],25:29,27:30},{5:[2,29],7:[2,29],9:[2,29],10:[2,29],13:[2,29],17:32,20:[2,29],22:14,23:[1,16]},{15:[1,33]},{15:[1,34]},{1:[2,1]},{4:35,6:3,8:4,10:[1,5],11:6,12:7,15:[1,8],16:9,17:10,18:11,19:[1,12],21:[1,15],22:14,23:[1,16],24:[1,13]},{6:36,8:4,10:[1,5],11:6,12:7,15:[1,8],16:9,17:10,18:11,19:[1,12],21:[1,15],22:14,23:[1,16],24:[1,13]},{5:[2,8],7:[2,8],9:[2,8],20:[2,8]},{14:[1,37]},{5:[2,19],7:[2,19],9:[2,19],10:[2,19],13:[2,19],17:38,20:[2,19],22:14,23:[1,16]},{5:[2,20],7:[2,20],9:[2,20],10:[2,20],13:[2,20],20:[2,20]},{5:[2,22],7:[2,22],9:[2,22],10:[2,22],13:[2,22],17:40,18:39,20:[2,22],21:[1,15],22:14,23:[1,16]},{5:[2,16],7:[2,16],9:[2,16],10:[2,16],13:[2,16],20:[2,16]},{5:[2,17],7:[2,17],9:[2,17],10:[2,17],13:[2,17],17:41,20:[2,17],22:14,23:[1,16]},{5:[2,15],7:[2,15],9:[2,15],10:[2,15],13:[2,15],20:[2,15]},{20:[1,42]},{26:[1,43]},{15:[1,31],25:44,26:[2,33],27:30},{28:[1,45]},{5:[2,30],7:[2,30],9:[2,30],10:[2,30],13:[2,30],20:[2,30]},{5:[2,27],7:[2,27],9:[2,27],10:[2,27],13:[2,27],20:[2,27],23:[2,27]},{5:[2,28],7:[2,28],9:[2,28],10:[2,28],13:[2,28],20:[2,28],23:[2,28]},{5:[2,3],20:[2,3]},{5:[2,5],7:[2,5],20:[2,5]},{5:[2,10],7:[2,10],9:[2,10],10:[2,10],20:[2,10]},{5:[2,21],7:[2,21],9:[2,21],10:[2,21],13:[2,21],20:[2,21]},{5:[2,23],7:[2,23],9:[2,23],10:[2,23],13:[2,23],17:46,20:[2,23],22:14,23:[1,16]},{5:[2,24],7:[2,24],9:[2,24],10:[2,24],13:[2,24],20:[2,24]},{5:[2,18],7:[2,18],9:[2,18],10:[2,18],13:[2,18],20:[2,18]},{5:[2,26],7:[2,26],9:[2,26],10:[2,26],13:[2,26],20:[2,26]},{5:[2,31],7:[2,31],9:[2,31],10:[2,31],13:[2,31],20:[2,31],21:[2,31],23:[2,31]},{26:[2,34]},{29:[1,47]},{5:[2,25],7:[2,25],9:[2,25],10:[2,25],13:[2,25],20:[2,25]},{15:[2,32],26:[2,32]}],defaultActions:{17:[2,1],44:[2,34]},parseError:function(b,c){throw new Error(b)},parse:function(b){function o(a){d.length=d.length-2*a,e.length=e.length-a,f.length=f.length-a}function p(){var a;return a=c.lexer.lex()||1,typeof a!="number"&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0,l=2,m=1;this.lexer.setInput(b),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var n=this.lexer.yylloc;f.push(n),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var q,r,s,t,u,v,w={},x,y,z,A;for(;;){s=d[d.length-1],this.defaultActions[s]?t=this.defaultActions[s]:(q==null&&(q=p()),t=g[s]&&g[s][q]);if(typeof t=="undefined"||!t.length||!t[0]){if(!k){A=[];for(x in g[s])this.terminals_[x]&&x>2&&A.push("'"+this.terminals_[x]+"'");var B="";this.lexer.showPosition?B="Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+A.join(", ")+", got '"+this.terminals_[q]+"'":B="Parse error on line "+(i+1)+": Unexpected "+(q==1?"end of input":"'"+(this.terminals_[q]||q)+"'"),this.parseError(B,{text:this.lexer.match,token:this.terminals_[q]||q,line:this.lexer.yylineno,loc:n,expected:A})}if(k==3){if(q==m)throw new Error(B||"Parsing halted.");j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,n=this.lexer.yylloc,q=p()}for(;;){if(l.toString()in g[s])break;if(s==0)throw new Error(B||"Parsing halted.");o(1),s=d[d.length-1]}r=q,q=l,s=d[d.length-1],t=g[s]&&g[s][l],k=3}if(t[0]instanceof Array&&t.length>1)throw new Error("Parse Error: multiple actions possible at state: "+s+", token: "+q);switch(t[0]){case 1:d.push(q),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(t[1]),q=null,r?(q=r,r=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,n=this.lexer.yylloc,k>0&&k--);break;case 2:y=this.productions_[t[1]][1],w.$=e[e.length-y],w._$={first_line:f[f.length-(y||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(y||1)].first_column,last_column:f[f.length-1].last_column},v=this.performAction.call(w,h,j,i,this.yy,t[1],e,f);if(typeof v!="undefined")return v;y&&(d=d.slice(0,-1*y*2),e=e.slice(0,-1*y),f=f.slice(0,-1*y)),d.push(this.productions_[t[1]][0]),e.push(w.$),f.push(w._$),z=g[d[d.length-2]][d[d.length-1]],d.push(z);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(b,c){if(!this.yy.parseError)throw new Error(b);this.yy.parseError(b,c)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},less:function(a){this._input=this.match.slice(a)+this._input},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=(new Array(a.length+1)).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e,f;this._more||(this.yytext="",this.match="");var g=this._currentRules();for(var h=0;h<g.length;h++){c=this._input.match(this.rules[g[h]]);if(c&&(!b||c[0].length>b[0].length)){b=c,d=h;if(!this.options.flex)break}}if(b){f=b[0].match(/\n.*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,g[d],this.conditionStack[this.conditionStack.length-1]);if(a)return a;return}if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var b=this.next();return typeof b!="undefined"?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)}};return a.options={},a.performAction=function(b,c,d,e){var f=e;switch(d){case 0:break;case 1:return 29;case 2:return 14;case 3:return 15;case 4:return 10;case 5:return 21;case 6:return 23;case 7:return 9;case 8:return"<";case 9:return 7;case 10:return 13;case 11:return 24;case 12:return 26;case 13:return 19;case 14:return 20;case 15:return 28;case 16:return"|";case 17:return 5;case 18:return"INVALID"}},a.rules=[/^\s+/,/^".*?"/,/^[0-9]+/,/^[a-zA-Z\$][a-zA-Z0-9\-\$]*/,/^\{.*?\}/,/^#/,/^\./,/^>/,/^</,/^\+/,/^\*/,/^\[/,/^\]/,/^\(/,/^\)/,/^=/,/^\|/,/^$/,/^./],a.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],inclusive:!0}},a}();return a.lexer=b,a}();typeof require!="undefined"&&typeof exports!="undefined"&&(exports.parser=p,exports.parse=function(){return p.parse.apply(p,arguments)},exports.main=function(b){if(!b[1])throw new Error("Usage: "+b[0]+" FILE");if(typeof process!="undefined")var c=require("fs").readFileSync(require("path").join(process.cwd(),b[1]),"utf8");else var d=require("file").path(require("file").cwd()),c=d.join(b[1]).read({charset:"utf-8"});return exports.parser.parse(c)},typeof module!="undefined"&&require.main===module&&exports.main(typeof process!="undefined"?process.argv.slice(1):require("system").args))})($);